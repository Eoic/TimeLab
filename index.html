<!doctype html>
<html lang="en" data-theme="light">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>TimeLab - time series data labeling tool</title>
        <link
            rel="stylesheet"
            href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
        />
    </head>

    <body>
        <div id="app" class="container">
            <div class="header flex justify-between items-center">
                <div>
                    <div class="brand">
                        <span class="material-symbols-outlined">vital_signs</span>
                        <strong> TimeLab </strong>
                        <div class="vertical"></div>
                        <p class="text-muted">Time-series data labeling tool</p>
                    </div>
                </div>
                <div>
                    <button
                        class="btn-icon btn-outline"
                        id="btn-settings"
                        aria-haspopup="listbox"
                        aria-label="Change theme"
                        title="Change theme"
                    >
                        <span class="material-symbols-outlined">palette</span>
                    </button>
                </div>
            </div>

            <div class="card toolbar">
                <div class="left" role="group" aria-label="File actions">
                    <button
                        class="btn-outline"
                        id="btn-upload-data"
                        aria-haspopup="dialog"
                        aria-controls="modal-data-upload"
                        aria-label="Upload data"
                        title="Upload data files"
                    >
                        <span class="material-symbols-outlined">upload</span>
                        <span>Upload data </span>
                    </button>
                    <button
                        class="btn-outline"
                        id="btn-manage-data"
                        aria-haspopup="dialog"
                        aria-controls="modal-data-manage"
                        aria-label="Manage data files"
                        title="Manage uploaded files"
                    >
                        <span class="material-symbols-outlined">folder_open</span>
                        <span>Manage data</span>
                    </button>
                    <button
                        class="btn-outline"
                        id="btn-load-example"
                        aria-haspopup="dialog"
                        aria-controls="modal-data-manage"
                        aria-label="Load example data"
                        title="Load example dataset"
                    >
                        <span class="material-symbols-outlined">auto_graph</span>
                        <span>Load example</span>
                    </button>
                    <button class="btn-outline" aria-label="Export labels">
                        <span class="material-symbols-outlined">export_notes</span>
                        <span>Export labels</span>
                    </button>
                </div>
                <div class="right" role="group" aria-label="Series navigation">
                    <button
                        class="btn-neutral"
                        id="toggle-labeled"
                        aria-pressed="false"
                        aria-label="Mark series as labeled"
                        title="Mark series as labeled"
                    >
                        <span class="material-symbols-outlined" aria-hidden="true"
                            >hourglass_empty</span
                        >
                        <span class="label">Unlabeled</span>
                    </button>
                    <button
                        class="btn-icon btn-neutral"
                        id="series-prev"
                        aria-label="Previous series"
                        title="Previous series"
                    >
                        <span class="material-symbols-outlined">navigate_before</span>
                    </button>
                    <span
                        id="series-indicator"
                        class="text-muted"
                        aria-live="polite"
                        aria-atomic="true"
                        >1 / 1</span
                    >
                    <button
                        class="btn-icon btn-neutral"
                        id="series-next"
                        aria-label="Next series"
                        title="Next series"
                    >
                        <span class="material-symbols-outlined">navigate_next</span>
                    </button>
                    <button
                        class="btn-icon btn-outline"
                        id="series-grid"
                        aria-haspopup="dialog"
                        aria-controls="modal-series-selector"
                        aria-label="Open series selector"
                        title="Open series selector"
                    >
                        <span class="material-symbols-outlined">grid_view</span>
                    </button>
                </div>
            </div>

            <!-- Chart Configuration Panel -->
            <div class="card config" id="panel-config">
                <div class="card-title" role="heading" aria-level="2">
                    <span class="material-symbols-outlined" aria-hidden="true">tune</span>
                    <h4>Chart configuration</h4>
                </div>
                <form class="form-grid" aria-label="Chart configuration">
                    <!-- Data mapping -->
                    <div class="section" aria-labelledby="cfg-data-heading">
                        <h5 id="cfg-data-heading" class="text-sm text-muted" style="margin: 0">
                            Data
                        </h5>
                        <div class="form-field">
                            <label for="x-axis">X axis (time/index)</label>
                            <tl-dropdown id="x-axis" placeholder="Choose column"></tl-dropdown>
                        </div>
                        <div class="form-field">
                            <label for="y-axis">Y axis (values)</label>
                            <tl-dropdown
                                id="y-axis"
                                placeholder="Choose column"
                                search
                            ></tl-dropdown>
                        </div>
                        <small class="text-muted text-sm">
                            Select columns from your dataset to define the chart axes.
                        </small>
                    </div>

                    <hr />

                    <!-- Appearance -->
                    <div class="section" aria-labelledby="cfg-appearance-heading">
                        <h5
                            id="cfg-appearance-heading"
                            class="text-sm text-muted"
                            style="margin: 0"
                        >
                            Appearance
                        </h5>
                        <div class="form-field">
                            <label
                                ><input type="checkbox" id="cfg-smooth" checked /> Smooth
                                line</label
                            >
                        </div>
                        <div class="form-field">
                            <label><input type="checkbox" id="cfg-area" checked /> Area fill</label>
                        </div>
                        <div class="form-field">
                            <label for="cfg-linewidth">Line width</label>
                            <input id="cfg-linewidth" type="range" min="1" max="6" value="2" />
                        </div>
                        <div class="form-field">
                            <label><input type="checkbox" id="cfg-points" /> Show points</label>
                        </div>
                        <div class="form-field">
                            <label for="cfg-sampling">Downsampling</label>
                            <tl-dropdown
                                id="cfg-sampling"
                                placeholder="Choose method"
                            ></tl-dropdown>
                        </div>
                    </div>

                    <hr />

                    <!-- Axes -->
                    <div class="section" aria-labelledby="cfg-axes-heading">
                        <h5 id="cfg-axes-heading" class="text-sm text-muted" style="margin: 0">
                            Axes
                        </h5>
                        <div class="form-field">
                            <label for="cfg-x-type">X axis type</label>
                            <tl-dropdown id="cfg-x-type" placeholder="Select type"></tl-dropdown>
                        </div>
                        <div class="form-field">
                            <label for="cfg-y-type">Y axis scale</label>
                            <tl-dropdown id="cfg-y-type" placeholder="Select scale"></tl-dropdown>
                        </div>
                        <div class="form-field">
                            <label
                                ><input type="checkbox" id="cfg-y-auto" checked /> Auto-scale
                                Y</label
                            >
                        </div>
                        <div class="form-field">
                            <label for="cfg-y-min">Y min</label>
                            <input
                                id="cfg-y-min"
                                type="number"
                                step="any"
                                placeholder="Auto"
                                disabled
                            />
                        </div>
                        <div class="form-field">
                            <label for="cfg-y-max">Y max</label>
                            <input
                                id="cfg-y-max"
                                type="number"
                                step="any"
                                placeholder="Auto"
                                disabled
                            />
                        </div>
                        <div class="form-field">
                            <label
                                ><input type="checkbox" id="cfg-gridlines" checked /> Show
                                gridlines</label
                            >
                        </div>
                    </div>

                    <hr />

                    <!-- Guides -->
                    <div class="section" aria-labelledby="cfg-guides-heading">
                        <h5 id="cfg-guides-heading" class="text-sm text-muted" style="margin: 0">
                            Guides
                        </h5>
                        <div class="form-field">
                            <label for="cfg-tooltip">Tooltip mode</label>
                            <tl-dropdown id="cfg-tooltip" placeholder="Select mode"></tl-dropdown>
                        </div>
                        <div class="form-field">
                            <label><input type="checkbox" id="cfg-snap" /> Snap to data</label>
                        </div>
                        <div class="form-field">
                            <label
                                ><input type="checkbox" id="cfg-threshold-enable" /> Threshold
                                line</label
                            >
                        </div>
                        <div class="form-field">
                            <label for="cfg-threshold-value">Threshold value</label>
                            <input
                                id="cfg-threshold-value"
                                type="number"
                                step="any"
                                placeholder="e.g. 60"
                                disabled
                            />
                        </div>
                    </div>

                    <hr />

                    <!-- View -->
                    <div class="section" aria-labelledby="cfg-view-heading">
                        <h5 id="cfg-view-heading" class="text-sm text-muted" style="margin: 0">
                            View
                        </h5>
                        <div class="form-field">
                            <label for="cfg-zoom-preset">Zoom preset</label>
                            <tl-dropdown
                                id="cfg-zoom-preset"
                                placeholder="Select preset"
                            ></tl-dropdown>
                        </div>
                    </div>
                </form>
            </div>

            <!-- Chart with floating micro-toolbar -->
            <div id="chart" class="card chart">
                <div id="chart-canvas" aria-label="Chart area" style="position: relative"></div>
                <div class="tools" role="toolbar" aria-label="Chart quick tools">
                    <button class="btn-icon btn-neutral" aria-label="Undo" title="Undo">
                        <span class="material-symbols-outlined">undo</span>
                    </button>
                    <button class="btn-icon btn-neutral" aria-label="Redo" title="Redo">
                        <span class="material-symbols-outlined">redo</span>
                    </button>
                    <button class="btn-icon btn-neutral" aria-label="Zoom out" title="Zoom out">
                        <span class="material-symbols-outlined">zoom_in</span>
                    </button>
                    <button class="btn-icon btn-neutral" aria-label="Zoom in" title="Zoom in">
                        <span class="material-symbols-outlined">zoom_out</span>
                    </button>
                    <button
                        class="btn-icon btn-neutral"
                        aria-label="Fit to view"
                        title="Fit to view"
                    >
                        <span class="material-symbols-outlined">fit_screen</span>
                    </button>
                    <button
                        class="btn-icon btn-neutral"
                        aria-label="Snap settings"
                        title="Snap settings"
                    >
                        <span class="material-symbols-outlined">point_scan</span>
                    </button>
                    <!-- Collapse/expand side panels -->
                    <button
                        class="btn-icon btn-neutral"
                        aria-controls="panel-config"
                        aria-label="Collapse configuration panel"
                        aria-expanded="true"
                        data-action="toggle-config"
                        title="Toggle left panel"
                    >
                        <span class="material-symbols-outlined">left_panel_close</span>
                    </button>
                    <button
                        class="btn-icon btn-neutral"
                        aria-controls="panel-stats"
                        aria-label="Collapse statistics panel"
                        aria-expanded="true"
                        data-action="toggle-stats"
                        title="Toggle bottom panel"
                    >
                        <span class="material-symbols-outlined">bottom_panel_close</span>
                    </button>

                    <button
                        class="btn-icon btn-neutral"
                        aria-controls="panel-labctrl"
                        aria-label="Collapse labels panel"
                        aria-expanded="true"
                        data-action="toggle-labctrl"
                        title="Toggle right panel"
                    >
                        <span class="material-symbols-outlined">right_panel_close</span>
                    </button>
                </div>
            </div>

            <!-- Right sidebar: labels panel -->
            <div class="card labctrl" id="panel-labctrl">
                <div class="card-title" role="heading" aria-level="2">
                    <span class="material-symbols-outlined" aria-hidden="true">label</span>
                    <h4>Labels</h4>
                </div>

                <!-- Toolbar actions -->
                <div
                    class="toolbar mini"
                    role="toolbar"
                    aria-label="Label actions"
                    style="flex-wrap: wrap; gap: 8px"
                >
                    <button
                        class="btn-icon btn-neutral"
                        aria-haspopup="dialog"
                        aria-controls="modal-label-new"
                        data-modal="label-new"
                        aria-label="New label"
                    >
                        <span class="material-symbols-outlined">add</span>
                    </button>
                    <button
                        class="btn-icon btn-neutral"
                        id="btn-manage-labels"
                        aria-label="Manage labels"
                        title="Manage labels"
                    >
                        <span class="material-symbols-outlined">tune</span>
                    </button>
                    <button
                        class="btn-icon btn-neutral"
                        aria-haspopup="dialog"
                        aria-controls="modal-label-merge"
                        data-modal="label-merge"
                        aria-label="Merge labels"
                    >
                        <span class="material-symbols-outlined">merge_type</span>
                    </button>
                </div>

                <!-- Active label selector -->
                <div class="active-label">
                    <tl-dropdown id="active-label" placeholder="Active label" search></tl-dropdown>
                </div>

                <!-- Labels and History tabs -->
                <div class="tabs" style="height: 100%">
                    <div class="tab-head">
                        <input type="radio" name="labels-tabs" id="tab-labels" checked />
                        <label for="tab-labels">Labels</label>
                        <input type="radio" name="labels-tabs" id="tab-history" />
                        <label for="tab-history">History</label>
                    </div>
                    <div class="panels">
                        <div class="tab-body panels">
                            <div
                                class="panel labels-panel"
                                role="region"
                                aria-labelledby="tab-labels"
                            >
                                <ul class="labels-list" role="list">
                                    <!-- Labels will be populated dynamically -->
                                </ul>
                            </div>
                            <div
                                class="panel history-panel"
                                role="region"
                                aria-labelledby="tab-history"
                            >
                                <ul class="history-list" role="listbox" aria-label="History">
                                    <!-- History will be populated dynamically -->
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Optional stats strip aligned to chart width -->
            <div class="card stats" id="panel-stats">
                <div class="card-title" role="heading" aria-level="2">
                    <span class="material-symbols-outlined" aria-hidden="true">analytics</span>
                    <h4>Statistics</h4>
                </div>
                <div class="stats-content" role="region" aria-label="Label statistics">
                    <div class="stats-summary">
                        <div class="stat">
                            <div class="label text-sm text-muted">Total labels</div>
                            <div class="value" id="stats-total">0</div>
                        </div>
                        <div class="stat">
                            <div class="label text-sm text-muted">Label types</div>
                            <div class="value" id="stats-types">0</div>
                        </div>
                    </div>
                    <div id="stats-list-wrap" class="stats-list-wrap">
                        <ul id="stats-list" class="stats-list" role="list"></ul>
                    </div>
                </div>
            </div>
        </div>
        <!-- Series selection modal -->
        <div
            class="modal"
            id="modal-series-selector"
            role="dialog"
            aria-modal="true"
            aria-hidden="true"
            aria-labelledby="series-modal-title"
        >
            <div class="modal-backdrop" data-close></div>
            <div class="modal-dialog modal-fluid card" role="document">
                <div class="card-title">
                    <span class="material-symbols-outlined" aria-hidden="true">grid_view</span>
                    <h4 id="series-modal-title">Select time series</h4>
                </div>
                <div
                    class="series-grid"
                    id="series-grid-container"
                    role="listbox"
                    aria-label="Time series list"
                ></div>
                <div class="mt-sm" style="display: flex; justify-content: flex-end">
                    <button class="btn-outline" id="series-modal-close" data-close>
                        <span class="material-symbols-outlined" aria-hidden="true">close</span>
                        Close
                    </button>
                </div>
            </div>
        </div>
        <!-- Data upload modal -->
        <div
            class="modal"
            id="modal-data-upload"
            role="dialog"
            aria-modal="true"
            aria-hidden="true"
            aria-labelledby="data-upload-title"
        >
            <div class="modal-backdrop" data-close></div>
            <div class="modal-dialog modal-fluid card" role="document">
                <div class="card-title">
                    <span class="material-symbols-outlined" aria-hidden="true">upload</span>
                    <h4 id="data-upload-title">Upload data files</h4>
                </div>

                <div
                    id="upload-dropzone"
                    class="upload-zone"
                    aria-label="File drop area"
                    tabindex="0"
                >
                    <input
                        id="upload-input"
                        type="file"
                        accept=".csv,.tsv,.txt,text/csv"
                        multiple
                        hidden
                    />
                    <div class="inner">
                        <span class="material-symbols-outlined" aria-hidden="true"
                            >cloud_upload</span
                        >
                        <div class="title">Drag and drop CSV/TSV files here</div>
                        <div class="subtitle text-sm text-muted">or</div>
                        <button id="upload-select" class="btn-primary" type="button">
                            <span class="material-symbols-outlined" aria-hidden="true">folder</span>
                            Select files
                        </button>
                        <div class="hint text-sm text-muted">
                            Files are saved locally in your browser
                        </div>
                    </div>
                </div>
                <div id="uploads-section" class="mt-sm" aria-hidden="true" style="display: none">
                    <div
                        style="
                            display: flex;
                            justify-content: space-between;
                            align-items: center;
                            margin: 0 0 8px;
                        "
                    >
                        <h5 class="text-sm text-muted" style="margin: 0">Selected files</h5>
                        <button id="uploads-clear" class="btn-ghost btn-sm" type="button">
                            <span class="material-symbols-outlined" aria-hidden="true"
                                >delete_sweep</span
                            >
                            Clear all
                        </button>
                    </div>
                    <div
                        id="uploads-list"
                        class="uploads-list"
                        role="list"
                        aria-live="polite"
                    ></div>
                </div>
                <div class="mt-sm" style="display: flex; justify-content: flex-end">
                    <button class="btn-outline" id="data-upload-close" data-close>
                        <span class="material-symbols-outlined" aria-hidden="true">close</span>
                        Close
                    </button>
                </div>
            </div>
        </div>

        <!-- Data management modal -->
        <div
            class="modal"
            id="modal-data-manage"
            role="dialog"
            aria-modal="true"
            aria-hidden="true"
            aria-labelledby="data-manage-title"
        >
            <div class="modal-backdrop" data-close></div>
            <div class="modal-dialog modal-fluid card" role="document">
                <div class="card-title">
                    <span class="material-symbols-outlined" aria-hidden="true">folder_open</span>
                    <h4 id="data-manage-title">Manage data files</h4>
                </div>
                <div
                    id="data-files-list"
                    class="files-list"
                    role="list"
                    aria-label="Uploaded files"
                ></div>
                <div class="mt-sm" style="display: flex; justify-content: flex-end; gap: 8px">
                    <button class="btn-outline" id="data-manage-close" data-close>
                        <span class="material-symbols-outlined" aria-hidden="true">close</span>
                        Close
                    </button>
                </div>
            </div>
        </div>

        <!-- New Label Modal -->
        <div
            class="modal"
            id="modal-label-new"
            role="dialog"
            aria-modal="true"
            aria-hidden="true"
            aria-labelledby="label-new-title"
        >
            <div class="modal-backdrop" data-close></div>
            <div class="modal-dialog card" role="document">
                <div class="card-title">
                    <span class="material-symbols-outlined" aria-hidden="true">add</span>
                    <h4 id="label-new-title">Create new label</h4>
                </div>

                <form id="label-new-form" class="form-grid" aria-label="New label form">
                    <div class="form-field">
                        <label for="label-name">Label name</label>
                        <input
                            id="label-name"
                            type="text"
                            placeholder="Enter label name"
                            required
                            aria-describedby="label-name-error"
                        />
                        <div id="label-name-error" class="form-error" aria-live="polite"></div>
                    </div>

                    <div class="form-field">
                        <label>Label color</label>
                        <div class="color-picker-section">
                            <div class="color-presets" role="radiogroup" aria-label="Preset colors">
                                <button
                                    type="button"
                                    class="color-preset"
                                    data-color="#e74c3c"
                                    aria-label="Red"
                                    style="background-color: #e74c3c"
                                ></button>
                                <button
                                    type="button"
                                    class="color-preset"
                                    data-color="#f39c12"
                                    aria-label="Orange"
                                    style="background-color: #f39c12"
                                ></button>
                                <button
                                    type="button"
                                    class="color-preset"
                                    data-color="#f1c40f"
                                    aria-label="Yellow"
                                    style="background-color: #f1c40f"
                                ></button>
                                <button
                                    type="button"
                                    class="color-preset"
                                    data-color="#2ecc71"
                                    aria-label="Green"
                                    style="background-color: #2ecc71"
                                ></button>
                                <button
                                    type="button"
                                    class="color-preset"
                                    data-color="#3498db"
                                    aria-label="Blue"
                                    style="background-color: #3498db"
                                ></button>
                                <button
                                    type="button"
                                    class="color-preset"
                                    data-color="#9b59b6"
                                    aria-label="Purple"
                                    style="background-color: #9b59b6"
                                ></button>
                                <button
                                    type="button"
                                    class="color-preset"
                                    data-color="#e91e63"
                                    aria-label="Pink"
                                    style="background-color: #e91e63"
                                ></button>
                                <button
                                    type="button"
                                    class="color-preset"
                                    data-color="#34495e"
                                    aria-label="Dark Blue"
                                    style="background-color: #34495e"
                                ></button>
                            </div>
                            <div class="custom-color-section">
                                <input
                                    id="label-color-custom"
                                    type="color"
                                    value="#3498db"
                                    aria-label="Custom color picker"
                                />
                                <label for="label-color-custom" class="custom-color-label"
                                    >Custom color</label
                                >
                            </div>
                        </div>
                    </div>
                </form>

                <div class="modal-actions">
                    <button class="btn-outline" type="button" data-close>
                        <span class="material-symbols-outlined" aria-hidden="true">close</span>
                        Cancel
                    </button>
                    <button
                        class="btn-primary"
                        type="submit"
                        form="label-new-form"
                        id="label-create-btn"
                    >
                        <span class="material-symbols-outlined" aria-hidden="true">add</span>
                        Create label
                    </button>
                </div>
            </div>
        </div>

        <!-- Label Management Modal -->
        <div
            class="modal"
            id="modal-label-manage"
            aria-hidden="true"
            role="dialog"
            aria-modal="true"
            aria-labelledby="label-manage-title"
        >
            <div class="modal-backdrop" data-close></div>
            <div class="modal-dialog modal-fluid card" role="document">
                <div class="card-title">
                    <span class="material-symbols-outlined" aria-hidden="true">tune</span>
                    <h4 id="label-manage-title">Manage labels</h4>
                </div>

                <div class="label-management-list" id="label-manage-list">
                    <!-- Label items will be populated here -->
                </div>

                <div class="mt-sm" style="display: flex; justify-content: flex-end">
                    <button class="btn-outline" data-close>
                        <span class="material-symbols-outlined" aria-hidden="true">close</span>
                        Done
                    </button>
                </div>
            </div>
        </div>

        <script type="module" src="/src/main.ts"></script>
    </body>
</html>
